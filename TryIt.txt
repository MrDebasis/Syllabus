        preprocessTableData(cases) {
            const sortedCases = this.sortTableData(cases, this.columnConfig);
            return sortedCases.map(row => {
                const updatedRow = { 
                    ...row, 
                    columns: [], 
                    showContent: false,
                    isExpanded: false,
                    detailRowKey: `${row.Id}-details`
                };
        
                this.columnConfig.forEach(column => {
                    if (column.visible) {
                        const fieldParts = column.column_id.split('.');
                        let fieldValue = row;
                        for (const part of fieldParts) {
                            fieldValue = fieldValue ? fieldValue[part] : undefined;
                        }
        
                        let value = fieldValue;
                        let isHyperlink = false;
                        let cellClass = ''; 
                        

                        if (column.column_id === 'NextActionDueDate__c') {
                            const dueDate = fieldValue ? new Date(fieldValue) : null;
                            const today = new Date();
                            today.setHours(0, 0, 0, 0);
                        
                            if (dueDate && dueDate > today) {
                                cellClass = 'highlight-red'; // Highlight red for future dates
                            } else if ([null, '', undefined].includes(fieldValue)) {
                                cellClass = 'highlight-yellow'; // Highlight yellow for blank or undefined
                            }
                        }

                        if (column.column_id === 'NextAction__c') {
                            if ([null, '', undefined].includes(fieldValue)) {
                                cellClass = 'highlight-yellow'; // Highlight yellow for blank or undefined
                            }
                        }
        
                        // Add hyperlink logic for specific columns
                        if (column.column_id === 'Account.Name') {
                            value = `<span class="patient-name">${fieldValue}</span></br><a href="/lightning/r/Case/${row.Id}/view" target="_blank">${row.CaseNumber}</a>`;
                            isHyperlink = true;
                        } else if (column.column_id === 'CartCoordinatorName__c') {
                            value = [null, '', undefined].includes(fieldValue) 
                            ? '' 
                            : fieldValue.includes('_self') 
                                ? fieldValue.replace('_self', '_blank') : fieldValue;  
                            isHyperlink = true;
                        } else if (column.column_id === 'TreatmentCenterName__c') {
                            value = `<a href="/lightning/r/Account/${row.TreatmentSite__c}/view" target="_blank">${fieldValue}</a>`;
                            isHyperlink = true;
                        }
        
                        updatedRow.columns.push({
                            field: column.column_id.toLowerCase(),
                            label: column.label,
                            value: value,
                            isHyperlink: isHyperlink,
                            dataType: column.data_type,
                            isEditing: false,
                            isEditable: column.editable || false,
                            isString: column.isString || false,
                            isNumber: column.isNumber || false,
                            isDate: column.isDate || false,
                            isPicklist: column.isPicklist || false,
                            options: column.isPicklist ? column.picklist_values.map(value => ({ label: value, value })) : null,
                            cellClass : cellClass
                        });
                    }
                });
        
                return updatedRow;
            });
        }


<div class="table-edit-container">
            <table class="slds-table slds-table_bordered slds-table_col-bordered">
                <thead>
                    <tr>
                        <th scope="col"></th> <!-- Toggle icon column -->
                        <template for:each={columnConfig} for:item="column">
                            <template if:true={column.visible}>
                                <th key={column.column_id} scope="col" class={column.ColumnWidth}>
                                    <div class="slds-grid slds-grid_vertical-align-center">
                                        <span class="font-style3 slds-m-right_xx-small">{column.label}</span>
                                        <template if:true={column.isSortingApplied}>
                                            <template if:true={column.IsAscsortDirection}>
                                                <lightning-button-icon
                                                    icon-name="utility:arrowup"
                                                    variant="bare"
                                                    size="small"
                                                    alternative-text="Sort Ascending"
                                                    data-column-id={column.column_id}
                                                    onclick={handleSort}>
                                                </lightning-button-icon>
                                            </template>
                                            <template if:true={column.IsDescsortDirection}>
                                                <lightning-button-icon
                                                    icon-name="utility:arrowdown"
                                                    variant="bare"
                                                    size="small"
                                                    alternative-text="Sort Descending"
                                                    data-column-id={column.column_id}
                                                    onclick={handleSort}>
                                                </lightning-button-icon>
                                            </template>
                                        </template>
                                    </div>
                                </th>
                            </template>
                        </template>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={processedCases} for:item="row">
                        <tr key={row.Id}>
                            <td>
                                <template if:true={row.isExpanded}>
                                    <lightning-button-icon
                                        icon-name="utility:dash"
                                        variant="bare"
                                        alternative-text="Collapse Details"
                                        data-id={row.Id}
                                        onclick={handleRowAction}>
                                    </lightning-button-icon>
                                </template>
                                <template if:false={row.isExpanded}>
                                    <lightning-button-icon
                                        icon-name="utility:add"
                                        variant="bare"
                                        alternative-text="Expand Details"
                                        data-id={row.Id}
                                        onclick={handleRowAction}>
                                    </lightning-button-icon>
                                </template>
                            </td>
                            <template for:each={row.columns} for:item="column">
                                <td key={column.field} class={column.cellClass}>
                                    <template if:true={column.isEditable}>
                                        <template if:true={column.isEditing}>
                                            <template if:true={column.isString}>
                                                <lightning-textarea
                                                    value={column.value}
                                                    data-id={row.Id}
                                                    data-field={column.field}
                                                    onchange={handleInputChange}
                                                    variant="label-hidden"
                                                >
                                                </lightning-textarea>
                                            </template>
                                            <template if:true={column.isNumber}>
                                                <lightning-input
                                                    type="number"
                                                    value={column.value}
                                                    data-id={row.Id}
                                                    data-field={column.field}
                                                    onchange={handleInputChange}
                                                    variant="label-hidden"
                                                >
                                                </lightning-input>
                                            </template>
                                            <template if:true={column.isDate}>
                                                <lightning-input
                                                    type="date"
                                                    value={column.value}
                                                    data-id={row.Id}
                                                    data-field={column.field}
                                                    onchange={handleInputChange}
                                                    variant="label-hidden"
                                                    >
                                                </lightning-input>
                                            </template>
                                            <template if:true={column.isPicklist}>
                                                <lightning-combobox
                                                    value={column.value}
                                                    data-id={row.Id}
                                                    data-field={column.field}
                                                    options={column.options}
                                                    onchange={handleInputChange}
                                                    variant="label-hidden"
                                                >
                                                </lightning-combobox>
                                            </template>
                                        </template>
                                    </template>
                                    <template if:false={column.isEditing}>
                                        <template if:true={column.isHyperlink}>
                                            <lightning-formatted-rich-text class="link-style" value={column.value}></lightning-formatted-rich-text>
                                        </template>
                                        <template if:false={column.isHyperlink}>
                                            <div class="slds-grid slds-grid_align-spread slds-grid_vertical-align-center">
                                                <span style="    display: -webkit-box;
                                                -webkit-box-orient: vertical;
                                                -webkit-line-clamp: 3;
                                                overflow: hidden;
                                                text-overflow: ellipsis;
                                                white-space: normal;">{column.value}</span>  
                                                <template if:true={column.isEditable}>
                                                    <lightning-button-icon
                                                        icon-name="utility:edit"
                                                        variant="bare"
                                                        class="slds-float_right"
                                                        alternative-text="Edit"
                                                        data-id={row.Id}
                                                        data-field={column.field}
                                                        onclick={handleEditClick}>
                                                    </lightning-button-icon>
                                                </template>                                              
                                            </div>
                                        </template>
                                    </template>
                                </td>
                            </template>
                        </tr>
                        <template if:true={row.isEditing}>
                            <tr key={row.detailRowKeyForSaveAndCancel}>
                                <td colspan={computedColspan}>
                                    <div class="slds-m-vertical_small" style="text-align: center;">
                                        <lightning-button
                                            label="Save"
                                            data-id={row.Id}
                                            onclick={handleSave}>
                                        </lightning-button>
                                        <lightning-button
                                            label="Cancel"
                                            data-id={row.Id}
                                            onclick={handleCancel}
                                            class="slds-m-left_x-small">
                                        </lightning-button>
                                    </div>
                                </td>
                            </tr>
                        </template>
                        <template if:true={row.showContent}>
                            <tr key={row.detailRowKey}>
                                <td colspan={computedColspan}>
                                    <div>
                                        <p>{row.Id}</p>
                                        <c-dynamic-datatable-debasis record-id={row.Id}></c-dynamic-datatable-debasis>
                                    </div>
                                </td>
                            </tr>
                        </template>
                    </template>
                </tbody>
            </table>
        </div>
