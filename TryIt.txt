updateNextActionStyling(row) {
    const nextActionCol = row.columns.find(col => col.field === 'nextaction__c');
    const dueDateCol = row.columns.find(col => col.field === 'nextactionduedate__c');

    if (!nextActionCol || !dueDateCol) return row;

    const dueDate = dueDateCol.value ? new Date(dueDateCol.value) : null;
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    if (dueDate && dueDate > today) {
        // Future date
        dueDateCol.cellClass = 'highlight-red';
        nextActionCol.cellClass = 'highlight-red';
    } else {
        // Due date is today or past
        dueDateCol.cellClass = ''; // no class
        if ([null, '', undefined].includes(nextActionCol.value)) {
            nextActionCol.cellClass = 'highlight-yellow';
        } else {
            nextActionCol.cellClass = ''; // filled
        }
    }

    return row;
}
