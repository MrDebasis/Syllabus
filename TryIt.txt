if (this.objectApiName === 'Trip__c') {
    this.columns.push({
        label: 'Itinerary',
        fieldName: 'itineraryURL',
        type: 'url',
        typeAttributes: {
            label: 'View',
            target: '_blank'
        },
        editable: false,
        sortable: false
    });
}


get getTripTable() {
    let tripTable = this.tables['Trip__c'];
    if (!tripTable || !tripTable.data || tripTable._isProcessed) {
        return tripTable;
    }

    const tripIds = tripTable.data.map(record => record.Id);

    if (tripIds.length > 0) {
        // Apex call to fetch ContentDocumentId per Trip
        getLatestTripContentDocumentMap({ tripIds })
            .then(docMap => {
                // Build Lightning record view URL
                const baseURL = window.location.origin;

                tripTable.data = tripTable.data.map(record => {
                    const docId = docMap[record.Id];
                    return {
                        ...record,
                        itineraryURL: docId ? `${baseURL}/lightning/r/ContentDocument/${docId}/view` : null
                    };
                });

                tripTable._isProcessed = true;
                this.tables['Trip__c'] = tripTable;
            })
            .catch(error => {
                console.error('Error fetching itinerary document map:', error);
            });
    }

    return tripTable;
}
