<template>
    <lightning-card title="Lead Comparison" icon-name="standard:lead">
        <lightning-datatable
            key-field="Id"
            data={data}
            columns={columns}
            onrowselection={handleRowSelection}
        ></lightning-datatable>

        <template if:true={selectedLeads.length}>
            <lightning-card title="Select Values for Comparison" icon-name="standard:related_list">
                <template for:each={selectedLeads} for:item="lead">
                    <div key={lead.Id} class="slds-p-around_small">
                        <h3>Lead ID: {lead.Id}</h3>
                        <lightning-radio-group
                            name="name"
                            label="Name"
                            options={nameOptions}
                            value={selectedLeadId.name}
                            onchange={handleRadioChange}
                        ></lightning-radio-group>
                        <lightning-radio-group
                            name="email"
                            label="Email"
                            options={emailOptions}
                            value={selectedLeadId.email}
                            onchange={handleRadioChange}
                        ></lightning-radio-group>
                        <lightning-radio-group
                            name="company"
                            label="Company"
                            options={companyOptions}
                            value={selectedLeadId.company}
                            onchange={handleRadioChange}
                        ></lightning-radio-group>
                    </div>
                </template>
                <lightning-button label="Save Selections" onclick={handleSave}></lightning-button>
            </lightning-card>
        </template>
    </lightning-card>
</template>


import { LightningElement, wire, api, track } from 'lwc';
import getLeadsByIds from '@salesforce/apex/LeadComparisonController.getLeadsByIds';

export default class LeadComparison extends LightningElement {
    @api recordIds = []; // IDs passed to the component
    @track data = [];
    @track selectedLeads = [];
    @track nameOptions = [];
    @track emailOptions = [];
    @track companyOptions = [];
    @track selectedLeadId = {
        name: '',
        email: '',
        company: ''
    };

    columns = [
        { label: 'Name', fieldName: 'Name' },
        { label: 'Email', fieldName: 'Email' },
        { label: 'Company', fieldName: 'Company' }
    ];

    @wire(getLeadsByIds, { leadIds: '$recordIds' })
    wiredLeads({ error, data }) {
        if (data) {
            this.data = data.map(lead => ({
                Id: lead.Id,
                Name: lead.Name,
                Email: lead.Email,
                Company: lead.Company
            }));
            this.setOptions();
        } else if (error) {
            console.error('Error fetching leads', error);
        }
    }

    setOptions() {
        if (this.selectedLeads.length > 0) {
            this.nameOptions = this.selectedLeads.map(lead => ({
                label: lead.Name,
                value: lead.Id
            }));
            this.emailOptions = this.selectedLeads.map(lead => ({
                label: lead.Email,
                value: lead.Id
            }));
            this.companyOptions = this.selectedLeads.map(lead => ({
                label: lead.Company,
                value: lead.Id
            }));
        }
    }

    handleRowSelection(event) {
        this.selectedLeads = event.detail.selectedRows;
        this.setOptions();
    }

    handleRadioChange(event) {
        const field = event.target.name;
        const selectedId = event.detail.value;

        // Find the lead with the selected ID
        const selectedLead = this.selectedLeads.find(lead => lead.Id === selectedId);

        if (selectedLead) {
            this.selectedLeadId = {
                ...this.selectedLeadId,
                [field]: selectedLead[field]
            };
        }
    }

    handleSave() {
        // Implement save logic to update lead with selected values
        console.log('Selected Values:', this.selectedLeadId);
        // Call Apex to save selected values
    }
}

.slds-p-around_small {
    padding: 0.5rem;
}

