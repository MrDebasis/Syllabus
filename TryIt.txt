for (String objName : objectColumnsMap.keySet()) {
        String soql;
        List<String> fields = new List<String>(objectFieldNamesMap.get(objName));
        String fieldStr = 'Id';
        if (!fields.isEmpty()) {
            fieldStr += ', ' + String.join(fields, ', ');
        }

        switch on objName {
            when 'Case' {
                soql = 'SELECT ' + fieldStr + ' FROM Case WHERE Id = :caseId';
            }
            when 'HealthCloudGA__ContactContactRelation__c' {
                soql = 'SELECT ' + fieldStr + ' FROM HealthCloudGA__ContactContactRelation__c WHERE Patient_Support_Case__c = :caseId AND RelatedRoleName__c != \'Patient\'';
            }
                when 'echosign_dev1__SIGN_Agreement__c' {
                soql = 'SELECT ' + fieldStr + ' FROM echosign_dev1__SIGN_Agreement__c WHERE Patient_Support_Case__c = :caseId AND RelatedRoleName__c != \'Patient\'';
            }
            when else {
                continue;
            }
        }

        try {
            List<SObject> records = Database.query(soql);
            resultMap.put(objName, new TableConfigWrapper(objName, objectColumnsMap.get(objName), records));
        } catch (Exception ex) {
            System.debug('Query failed for ' + objName + ': ' + ex.getMessage());
        }
    }

    return resultMap;
}
