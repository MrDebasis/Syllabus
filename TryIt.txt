private static List<ContentVersion> createContentVersion(String base64, String filename) {
    if (String.isBlank(base64) || String.isBlank(filename)) {
        Application.logentry.error('Base64 string or filename is null or empty.');
        return new List<ContentVersion>();  // Return an empty list to avoid null pointer issues
    }

    List<ContentVersion> cvList = new List<ContentVersion>();
    ContentVersion cv = new ContentVersion();
    cv.VersionData = EncodingUtil.base64Decode(base64);
    cv.Title = filename + '.jpeg';
    cv.PathOnClient = filename;

    try {
        service().insertContentversion(cvList);
        Application.logentry.info('ContentVersion successfully created: ' + cvList);
        return cvList;
    } catch (DMLException e) {
        Application.logentry.error('Error inserting ContentVersion: ' + e.getMessage());
        return new List<ContentVersion>();  // Return an empty list on failure
    }
}
